# Директивы ассемблера: .text, .bss, .data, .rodata, .byte, .long, .string, .zero, .align.

## **1. Введение в директивы ассемблера**

**Директивы** — это команды ассемблеру (не процессору!), которые управляют:

- Организацией памяти
- Распределением данных
- Выравниванием
- Генерацией кода

Отличаются от инструкций процессора тем, что:
✔ Не транслируются в машинный код
✔ Выполняются на этапе ассемблирования

## **2. Сегментные директивы**

Управляют размещением данных и кода в памяти.

### **2.1. `.text`**

**Назначение**:

- Определяет сегмент кода (исполняемые инструкции)
- По умолчанию имеет права **Read-Execute**

**Пример (NASM):**

```asm
section .text
global _start   ; Точка входа

_start:
    mov eax, 1  ; Системный вызов exit
    int 0x80
```

### **2.2. `.data`**

**Назначение**:

- Содержит **инициализированные** данные
- Права: **Read-Write**

**Пример:**

```asm
section .data
    count dd 42          ; 32-битное число
    msg db "Hello", 0   ; Строка с нулём на конце
```

### **2.3. `.bss` (Block Started by Symbol)**

**Назначение**:

- Резервирует память для **неинициализированных** данных
- Права: **Read-Write**
- Экономит место в исполняемом файле

**Пример:**

```asm
section .bss
    buffer resb 256      ; Буфер 256 байт
    array resd 100       ; Массив 100 dword (4-байтных) элементов
```

### **2.4. `.rodata`**

**Назначение**:

- Только для чтения (константы, строки)
- Права: **Read-Only**

**Пример (GAS):**

```asm
.section .rodata
    pi: .float 3.1415926
    const_str: .asciz "Immutable"
```

## **3. Директивы определения данных**

### **3.1. `.byte` / `db`**

- Резервирует **1 байт**

```asm
section .data
    flags db 0x01, 0x02, 0x03  ; 3 байта
```

### **3.2. `.word` / `dw`**

- Резервирует **2 байта** (16 бит)

```asm
    port dw 0x80C0
```

### **3.3. `.long` / `dd`**

- Резервирует **4 байта** (32 бита)

```asm
    address dd 0x12345678
```

### **3.4. `.quad` / `dq`**

- Резервирует **8 байт** (64 бита)

```asm
    big_num dq 0xFFFF_FFFF_FFFF_FFFF
```

### **3.5. `.string` / `.asciz`**

- Строка с нулевым окончанием

```asm
    greeting db "Hello", 0    ; NASM
    greeting: .asciz "World"  ; GAS
```

### **3.6. `.zero N`**

- Заполняет **N байт** нулями

```asm
    padding: .zero 16  ; 16 нулевых байт
```

## **4. Директивы выравнивания**

### **4.1. `.align N`**

- Выравнивает текущий адрес до границы **2^N**

```asm
section .data
    .align 4         ; Выравнивание по 16 байтам (2^4)
    aligned_data dd 0
```

**Важность выравнивания**:

- Ускоряет доступ к данным (особенно для SSE/AVX)
- Требуется для атомарных операций
- Обязательно для некоторых системных структур

## **8. Вывод**

- Директивы управляют **организацией памяти** на этапе ассемблирования
- Критичны для:
  - Оптимизации производительности
  - Корректной работы с системными вызовами
  - Эффективного использования ресурсов
- Понимание директив необходимо для:
  - Написания оптимизированного ассемблерного кода
  - Анализа дампов памяти
  - Разработки компиляторов
